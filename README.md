## Проект

### Автоматизация
1. В папке jenkins настроен докер образ для jenkins и jenkinsFile с описанием пайплайна для проекта
2. Для самого проекта написаны dockerfile и docker-compose файлы
3. Имеется github ci

### Описание приложения
Это приложение позволяет определить является ли какая-либо картинка рекламной. 
В соц сетях часто выкладывают посты с рекламой, не говоря об этом что это реклама, зашивая необходимые законодательствам метки в картинки.
Законом определенно что любая реклама(кроме социальной) должна содержать уникальный идентификатор рекламы - erid. 
Данное приложения с помощью методов компьютерного зрения считывает текст с картинки и анализуреет есть ли в нем erid.

Само приложение применимо для автоматизированных средств фильтрации какого-либо контента из соц сетей.

Для реализации методов компьютерного зрения используется предобученная модель [PaddleOCR](https://github.com/PaddlePaddle/PaddleOCR/tree/main).  


### Запуск
Для запуска приложения, нужно выполнить команду - uvicorn api:app --reload, предварительно установив библиотеки
из файла requirements.txt.  
Приложение запустится по умолчанию на 8000 порту, по адресу http://localhost:8000/docs будет доступен swagger ui.  
Также можно запустить приложения через docker, выполнив команду - docker compose up, оно запустится на 80 порту. 


### Описание API
Приложение предоставляет 1 метод:  
POST Метод /image/ads/analyze который принимает на вход список файлов в виде multipart form data.  
Логика работы следующая: сначала изображение попадает в модель и переводится в текст, 
далее текст очищается от лишнего и анализируется на содержание подстроки или сравнивается с помощью алгоритма расстояния Левенштейна. 
Если распознаные фрагменты текста содержат метку erid или реклама, то такое изображение относится к рекламному, если не содержит, значит обычное изображение или модель не смогла распознать.  
Также предусмотрен слуай когда метка может быть искажена и алгоритм нашел почти точное совпадение, в таком случае данное изображение возможно является рекламным.  

На выход метод отдает json, где по имени каждого файла отображен результат работы метода, результат представлен в виде кода статуса 0 - не реклама, 1 - реклама, 2 - возможно реклама:  
```
{
  "6.jpg": 0,
  "5.jpg": 1
}
```

### Развертывание
Для развертывания был написан Dockerfile и docker-compose.yaml файл для быстрого развертывания api и модели.  
Для локального запуска docker контейнера, необходимо из папки с docker-compose файлом выполнить команду - docker compose up.
Swagger будет доступен по ссылке - http://localhost/docs

### Тесты
Были написаны тесты для api.
Тесты покрывают основные сценарии использования api и проверку что модель различает рекламу или нет. 
Для локального запуска тестов необходимо сначала установить все зависимости из requirements_test.txt, далее выполнить команду pytest.

### CI
Также был настроен github ci для автоматизированного запуска тестов и линтера при любом коммите или pr в ветку master.  
Декларативное описание ci находится в файле по следующему пути: .github/workflows/python-app.yml.